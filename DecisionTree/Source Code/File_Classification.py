import Node

data = [[]]
f = open('C:/Users/trieu/PycharmProjects/DecisionTree/ExportTesting.csv')
for line in f:
	line = line.strip("\r\n")
	data.append(line.split(','))
data.remove([])
tree = {'e_magic': {'23117': {'e_cblp': {'17739': '0', '0': '0', '144': {'e_cp': {'8': '1', '3': {'e_crlc': {'0': {'e_cparhdr': {'4': {'e_minalloc': {'0': {'e_maxalloc': {'65535': {'e_ss': {'0': {'e_sp': {'184': {'e_csum': {'0': {'e_ip': {'0': {'e_cs': {'0': {'e_lfarlc': {'1': '1', '64': {'e_ovno': {'0': {'e_res': {'': {'e_oemid': {'0': {'e_oeminfo': {'0': {'e_res2': {'': {'e_lfanew': {'216': {'Machine': {'332': {'NumberOfSections': {'12': '1', '3': {'CreationYear': {'2002': '0', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': '0', '259': '1'}}}}}}}}, '2010': '1', '2004': '1', '2005': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': '0', '259': '1'}}}}}}}}}}, '2': '0', '5': {'CreationYear': {'2003': '0', '2006': '0', '2007': '0', '2004': '0', '2005': '0', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': '1', '258': {'Magic': {'267': {'MajorLinkerVersion': {'10': '1', '12': '0', '8': '0'}}}}}}}}}}}}, '2012': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'259': {'Magic': {'267': {'MajorLinkerVersion': {'10': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'26112': {'SizeOfInitializedData': {'17408': '1', '16896': '0'}}}}}}}}}}}}}}}}}}}}, '4': {'CreationYear': {'1998': '0', '2002': '1', '2001': '0', '2008': '0', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': '0', '258': '1', '259': '0'}}}}}}}}, '2012': '1'}}, '7': '0', '6': {'CreationYear': {'2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': {'Magic': {'267': {'MajorLinkerVersion': {'10': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'73728': '0', '65024': '1'}}}}}}}}}}}}}}}}, '2010': '1', '2012': '0'}}}}}}, '200': {'Machine': {'332': {'NumberOfSections': {'20': '1', '3': {'CreationYear': {'2011': '1', '2012': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'6': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'32768': {'SizeOfInitializedData': {'12288': '0', '4096': '1'}}}}}}}}}}}}}}}}}}}}, '5': {'CreationYear': {'2011': '0', '2010': '1', '2012': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': '1', '259': '0'}}}}}}}}}}, '4': {'CreationYear': {'2005': '1', '2012': '0'}}, '7': '0', '6': '1'}}}}, '144': '1', '208': {'Machine': {'332': {'NumberOfSections': {'10': '0', '13': '0', '12': '0', '3': '0', '2': '0', '5': {'CreationYear': {'2002': '0', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'5': '0', '6': '1'}}}}, '258': '0'}}}}}}}}, '2007': '0', '2012': '0'}}, '4': {'CreationYear': {'2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'270': '0', '271': '0', '258': '0', '259': {'Magic': {'267': {'MajorLinkerVersion': {'9': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'46592': {'SizeOfInitializedData': {'20480': '0', '27648': '0', '20992': {'SizeOfUninitializedData': {'0': {'AddressOfEntryPoint': {'9922': '1', '10418': '0'}}}}}}}}}}}}}}}}}}}}}}}}, '7': {'CreationYear': {'2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': {'Magic': {'267': {'MajorLinkerVersion': {'10': '1', '12': '0'}}}}}}}}}}}}, '2010': '1'}}, '6': {'CreationYear': {'2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': {'Magic': {'267': {'MajorLinkerVersion': {'9': '1', '10': '0'}}}}}}}}}}}}}}, '8': '1'}}}}, '192': {'Machine': {'332': {'NumberOfSections': {'3': {'CreationYear': {'2012': '1', '2011': '0', '2010': '1', '2007': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'9': '0', '0': '1'}}}}}}}}}}}}}}, '2': '1', '5': {'CreationYear': {'2008': '0', '2011': '1'}}, '4': '1', '23': '1'}}}}, '288': '1', '272': '1', '124': '0', '240': {'Machine': {'332': {'NumberOfSections': {'3': {'CreationYear': {'2009': '1', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'8': '0', '5': '1', '7': '0'}}}}, '258': '1'}}}}}}}}}}, '5': {'CreationYear': {'2009': '1', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': {'Magic': {'267': {'MajorLinkerVersion': {'9': '0', '8': '1'}}}}}}}}}}}}, '2010': '0', '2012': '1'}}, '4': {'CreationYear': {'1996': '1', '2007': '1', '2005': '0', '2009': '1', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'6': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'94208': '0', '45056': '1'}}}}}}}}, '259': '0'}}}}}}}}, '2010': '1', '2012': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'7': {'MinorLinkerVersion': {'10': {'SizeOfCode': {'20480': {'SizeOfInitializedData': {'20480': '1', '200704': '0'}}}}}}}}}}}}}}}}}}}}, '7': '0', '6': {'CreationYear': {'2008': '1', '2009': '1', '2011': '0', '2010': '0'}}, '9': '1'}}}}, '184': {'Machine': {'332': {'NumberOfSections': {'3': {'CreationYear': {'2008': '1', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'6': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'110592': '0', '221184': '0', '61440': '0', '208896': '0', '176128': '0', '114688': '0', '151552': '0', '77824': '0', '73728': {'SizeOfInitializedData': {'233472': '1', '4096': '0', '155648': '0'}}, '237568': '0', '86016': '1'}}}}}}}}}}}}}}}}, '2010': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'6': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'208896': '1', '27648': '0', '77824': '0'}}}}}}}}}}}}}}}}, '2012': '0'}}}}}}, '264': {'Machine': {'332': {'NumberOfSections': {'3': '0', '4': '1'}}}}, '128': {'Machine': {'332': {'NumberOfSections': {'12': '0', '16': '0', '3': {'CreationYear': {'2011': '1', '2010': '0', '2005': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'270': '0', '271': '0', '266': {'Magic': {'267': {'MajorLinkerVersion': {'8': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'221184': '1', '249856': '0'}}}}}}}}}}}}}}}}}}, '5': {'CreationYear': {'1998': '1', '2007': '1', '2004': '0', '2008': '0', '2009': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'7': {'MinorLinkerVersion': {'10': {'SizeOfCode': {'512': '0', '4096': '1'}}}}}}}}, '259': '0'}}}}}}}}, '2011': '0', '2010': '1', '2012': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'270': '0', '271': {'Magic': {'267': {'MajorLinkerVersion': {'2': {'MinorLinkerVersion': {'50': {'SizeOfCode': {'20480': '0', '3026432': '1'}}}}}}}}}}}}}}}}}}, '4': {'CreationYear': {'1995': '0', '2003': '0', '2007': '1', '2004': '1', '2005': '0', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': '0', '258': {'Magic': {'267': {'MajorLinkerVersion': {'8': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'13824': '0', '41984': '1'}}}}}}}}}}}}}}}}, '2012': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'270': '1', '271': '0'}}}}}}}}}}, '7': '0', '6': {'CreationYear': {'2009': '1', '2012': '0'}}, '9': '0', '8': '1'}}}}, '176': {'Machine': {'332': {'NumberOfSections': {'3': {'CreationYear': {'2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'6': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'196608': '0', '258048': '0', '122880': '1', '77824': '0'}}}}}}}}}}}}}}}}, '2010': '1', '2012': '0'}}, '29': '0'}}}}, '224': {'Machine': {'332': {'NumberOfSections': {'3': {'CreationYear': {'2012': '0', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'8': '1', '5': '0', '7': '0', '6': '1'}}}}, '259': '0'}}}}}}}}, '2005': '0'}}, '5': {'CreationYear': {'2002': '0', '2007': '0', '2004': '0', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'270': '0', '258': {'Magic': {'267': {'MajorLinkerVersion': {'11': '0', '10': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'38400': '1', '37888': '0'}}}}, '8': '0'}}}}}}}}}}}}, '2010': '1', '2012': '1'}}, '4': {'CreationYear': {'2008': '0', '2012': '0', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': {'Magic': {'267': {'MajorLinkerVersion': {'5': '0', '6': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'8192': '0', '12288': '0', '36352': '0', '90112': '1'}}}}}}}}, '258': '0', '259': '0'}}}}}}}}, '2010': '1', '2005': '0'}}, '7': '0', '6': {'CreationYear': {'2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': {'Magic': {'267': {'MajorLinkerVersion': {'18': '1', '12': '0'}}}}}}}}}}}}, '2010': '1'}}, '9': '1', '8': {'CreationYear': {'2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': {'Magic': {'267': {'MajorLinkerVersion': {'9': '0', '10': '1'}}}}}}}}}}}}}}}}}}, '256': {'Machine': {'332': {'NumberOfSections': {'3': {'CreationYear': {'2008': '0', '2009': '1', '2011': '0', '2007': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': '0', '259': '1'}}}}}}}}, '2013': '0'}}, '5': {'CreationYear': {'2009': '1', '2011': '0'}}, '4': {'CreationYear': {'2003': '0', '2011': '0', '2010': '1', '1997': '1'}}, '6': '1'}}}}, '248': {'Machine': {'332': {'NumberOfSections': {'11': '0', '3': {'CreationYear': {'2009': '1', '2004': '0', '2012': '1'}}, '5': {'CreationYear': {'2009': '1', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': '0', '258': {'Magic': {'267': {'MajorLinkerVersion': {'9': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'52736': '0', '122880': '1'}}}}}}}}}}}}}}}}, '2010': '1'}}, '4': {'CreationYear': {'2004': '0', '2102': '1', '2008': '0', '2009': '1', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': '0', '259': '1'}}}}}}}}, '2010': '1'}}, '7': '0', '6': '1', '8': '0'}}}}, '232': {'Machine': {'332': {'NumberOfSections': {'10': '0', '3': {'CreationYear': {'2001': '1', '2005': '0'}}, '5': {'CreationYear': {'2009': '1', '2011': '0', '2010': '1'}}, '4': {'CreationYear': {'1970': '0', '2004': '0', '2005': '0', '2009': '1', '2011': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'258': {'Magic': {'267': {'MajorLinkerVersion': {'9': {'MinorLinkerVersion': {'0': {'SizeOfCode': {'0': '0', '38400': '1', '65536': '0'}}}}}}}}, '259': '0', '8450': '0'}}}}}}}}, '2010': '0', '2012': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'271': '1', '258': '0', '259': '0'}}}}}}}}}}, '6': {'CreationYear': {'2009': '1', '2011': '0', '2010': '1'}}}}}}}}}}}}, '256': {'e_oeminfo': {'41920': '0', '49831': '1'}}}}, '\xa4\xf1]\xbc\xa0\xf1]\xbc': '1', '\x83': '1'}}}}}}}}}}}}}}}}}}}}}}}}, '2': '1'}}, '80': {'e_cp': {'3': '1', '2': {'e_crlc': {'0': {'e_cparhdr': {'4': {'e_minalloc': {'15': {'e_maxalloc': {'65535': {'e_ss': {'0': {'e_sp': {'0': '1', '184': {'e_csum': {'0': {'e_ip': {'0': {'e_cs': {'0': {'e_lfarlc': {'64': {'e_ovno': {'26': {'e_res': {'': {'e_oemid': {'0': {'e_oeminfo': {'0': {'e_res2': {'': {'e_lfanew': {'216': '1', '124': '1', '512': '0', '256': {'Machine': {'332': {'NumberOfSections': {'10': '1', '3': {'CreationYear': {'1992': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'33166': '1', '33167': {'Magic': {'267': {'MajorLinkerVersion': {'2': {'MinorLinkerVersion': {'25': {'SizeOfCode': {'339968': '1', '430080': '1', '176128': '1', '483328': '1', '73728': '1', '49152': '0'}}}}}}}}}}}}}}}}, '1997': '0', '2000': '1', '2011': '1', '2010': '0', '2012': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'33167': {'Magic': {'267': {'MajorLinkerVersion': {'2': {'MinorLinkerVersion': {'25': {'SizeOfCode': {'208896': '0', '286720': '1'}}}}}}}}}}}}}}}}}}, '4': '0', '7': '1', '6': '1', '9': '0', '8': {'CreationYear': {'1992': {'PointerToSymbolTable': {'0': {'NumberOfSymbols': {'0': {'SizeOfOptionalHeader': {'224': {'Characteristics': {'33166': {'Magic': {'267': {'MajorLinkerVersion': {'2': {'MinorLinkerVersion': {'25': {'SizeOfCode': {'33280': '1', '55808': '0', '107520': '0', '45568': '0', '168448': '1', '124928': '0', '14336': '0', '93696': '1', '39424': '1', '12288': '0', '52736': '1'}}}}}}}}}}}}}}}}, '2010': '0'}}}}}}, '64': '0'}}}}}}, '18432': '1'}}}}}}}}}}}}}}}}}}}}}}}}}}}}, '128': '1'}}}}
attributes = ['e_magic', 'e_cblp', 'e_cp', 'e_crlc', 'e_cparhdr', 'e_minalloc', 'e_maxalloc', 'e_ss', 'e_sp', 'e_csum', 'e_ip', 'e_cs', 'e_lfarlc', 'e_ovno', 'e_res', 'e_oemid', 'e_oeminfo', 'e_res2', 'e_lfanew', 'Machine', 'NumberOfSections', 'CreationYear', 'PointerToSymbolTable', 'NumberOfSymbols', 'SizeOfOptionalHeader', 'Characteristics', 'Magic', 'MajorLinkerVersion', 'MinorLinkerVersion', 'SizeOfCode', 'SizeOfInitializedData', 'SizeOfUninitializedData', 'AddressOfEntryPoint', 'BaseOfCode', 'BaseOfData', 'ImageBase', 'SectionAlignment', 'FileAlignment', 'MajorOperatingSystemVersion', 'MinorOperatingSystemVersion', 'MajorImageVersion', 'MinorImageVersion', 'MajorSubsystemVersion', 'MinorSubsystemVersion', 'SizeOfImage', 'SizeOfHeaders', 'CheckSum', 'Subsystem', 'DllCharacteristics', 'SizeOfStackReserve', 'SizeOfStackCommit', 'SizeOfHeapReserve', 'SizeOfHeapCommit', 'LoaderFlags', 'NumberOfRvaAndSizes', 'Flag']
count = 0
for entry in data:
	count += 1
	tempDict = tree.copy()
	result = ""
	while(isinstance(tempDict, dict)):
		root = Node.Node(tempDict.keys()[0], tempDict[tempDict.keys()[0]])
		tempDict = tempDict[tempDict.keys()[0]]
		index = attributes.index(root.value)
		value = entry[index]
		if(value in tempDict.keys()):
			child = Node.Node(value, tempDict[value])
			result = tempDict[value]
			tempDict = tempDict[value]
		else:
			result = "Can't defined malware"
			break
	print ("Malware %s : %s" % (count, result))
